(this["webpackJsonpreact-mesto-auth"]=this["webpackJsonpreact-mesto-auth"]||[]).push([[0],{34:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n(1),r=n.n(s),c=n(26),i=n.n(c),o=(n(34),n(5)),u=n(28),l=n(4),d=n(3),b=n.p+"static/media/header-logo.ff16f24b.svg",p=n(12),j=n(7),h=n.n(j),f=Object(s.createContext)();function m(e){var t=e.logo,n=e.loggedIn,r=e.onExit,c=Object(s.useState)(!1),i=Object(l.a)(c,2),o=i[0],u=i[1],b=Object(s.useContext)(f);return Object(a.jsxs)("header",{className:h()("header",{header_compact:n}),children:[Object(a.jsx)("a",{href:"#0",children:Object(a.jsx)("img",{src:t,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u041c\u0435\u0441\u0442\u043e.",className:"header__logo"})}),Object(a.jsxs)("div",{className:h()("header__navbar",{header__navbar_vertical:n,header__navbar_hidden:n&&!o}),children:[Object(a.jsxs)(d.b,{exact:!0,path:"/",children:[Object(a.jsx)("p",{className:"header__email",children:b.email}),Object(a.jsx)(p.b,{to:"/sign-in",className:"header__nlink",children:Object(a.jsx)("button",{className:"header__btn header__btn_type_exit",onClick:function(){r()},children:"\u0412\u044b\u0439\u0442\u0438"})})]}),Object(a.jsx)(d.b,{path:"/sign-in",children:Object(a.jsx)(p.b,{to:"/sign-up",className:"header__nlink",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})}),Object(a.jsx)(d.b,{path:"/sign-up",children:Object(a.jsx)(p.b,{to:"/sign-in",className:"header__nlink",children:"\u0412\u043e\u0439\u0442\u0438"})})]}),n&&Object(a.jsx)("button",{className:h()("header__btn header__btn_type_switch",{header__btn_action_close:o,header__btn_action_open:!o}),onClick:function(){u(!o)}})]})}function _(e){var t=e.card,n=e.onCardClick,r=e.onCardLike,c=e.onCardDelete,i=Object(s.useContext)(f);return Object(a.jsxs)("li",{className:"card",children:[i._id===t.owner._id&&Object(a.jsx)("button",{className:"card__btn card__btn_action_trush",type:"button",onClick:function(){c(t)}}),Object(a.jsx)("img",{src:t.link,alt:t.name,className:"card__image",onClick:function(){n(t)}}),Object(a.jsxs)("div",{className:"card__footer",children:[Object(a.jsx)("h3",{className:"card__caption",children:t.name}),Object(a.jsxs)("div",{className:"like card__like",children:[Object(a.jsx)("button",{className:h()("like__btn",{like__btn_active:t.likes.some((function(e){return e._id===i._id}))}),onClick:function(){r(t)},type:"button"}),Object(a.jsx)("p",{className:"like__count",title:t.likes.reduce((function(e,t){return e+"".concat(t.name,"\n")}),""),children:t.likes.length})]})]})]})}function O(e){var t=e.onEditAvatar,n=e.onEditProfile,r=e.onAddPlace,c=e.cards,i=e.onCardClick,o=e.onCardLike,u=e.onCardDelete,l=Object(s.useContext)(f);return Object(a.jsxs)("main",{className:"content",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("button",{className:"profile__btn profile__btn_action_edit-avatar",onClick:t,children:[Object(a.jsx)("img",{src:l.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440.",className:"profile__avatar"}),Object(a.jsx)("span",{className:"profile__avatar-overlay"})]}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsx)("h1",{className:"profile__name",children:l.name}),Object(a.jsx)("button",{className:"profile__btn profile__btn_action_edit",type:"button",onClick:n}),Object(a.jsx)("p",{className:"profile__about",children:l.about})]}),Object(a.jsx)("button",{className:"profile__btn profile__btn_action_add",type:"button",onClick:r})]}),Object(a.jsx)("section",{children:Object(a.jsx)("ul",{className:"cards",children:c.map((function(e){return Object(a.jsx)(_,{card:e,onCardClick:i,onCardLike:o,onCardDelete:u},e._id)}))})})]})}function v(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsxs)("p",{className:"footer__copyright",children:["@ ",(new Date).getFullYear()," \u041f\u043e\u043f\u043e\u0432 \u0410\u043b\u0435\u043a\u0441\u0435\u0439"]})})}function g(e){var t=e.card,n=e.isOpen,s=e.onClose;return Object(a.jsx)("div",{className:"popup popup_type_show ".concat(n?"popup_opened":""),onClick:function(e){e.target===e.currentTarget&&s()},children:Object(a.jsxs)("div",{className:"popup__container popup__container_type_show",children:[Object(a.jsx)("button",{className:"popup__btn popup__btn_action_close",type:"button",onClick:s}),Object(a.jsx)("img",{src:t.link,alt:t.name,className:"popup__image"}),Object(a.jsx)("h3",{className:"popup__caption",children:t.name})]})})}var x={title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add",submitStates:{static:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",loading:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435..."}},k={title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit",submitStates:{static:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",loading:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."}},y={title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"edit-avatar",submitStates:{static:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",loading:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."}},C={title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"confirm",submitStates:{static:"\u0414\u0430",loading:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."}},S={title:"\u0412\u0445\u043e\u0434",name:"login",submitStates:{static:"\u0412\u043e\u0439\u0442\u0438",loading:"\u0412\u0445\u043e\u0434\u0438\u043c..."}},N={title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",name:"Register",submitStates:{static:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",loading:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0435\u043c\u0441\u044f..."}},w=n(15),L=n(13),P=Object(s.createContext)({});function E(e){var t=e.name,n=e.className,r=e.isOpen,c=e.validators,i=e.onSubmit,u=e.defaultValues,d=e.children,b=Object(s.useState)({}),p=Object(l.a)(b,2),j=p[0],h=p[1],f=Object(s.useState)({}),m=Object(l.a)(f,2),_=m[0],O=m[1],v=Object(s.useState)({}),g=Object(l.a)(v,2),x=g[0],k=g[1],y=Object(s.useState)(!0),C=Object(l.a)(y,2),S=C[0],N=C[1];Object(s.useEffect)((function(){h(u)}),[u]),Object(s.useEffect)((function(){r||(O({}),h(u))}),[r,u]);Object(s.useEffect)((function(){var e=Object.keys(j).map((function(e){var t=j[e];if(!c[e])return{};var n=Object.entries(c[e]).map((function(e){var n=Object(l.a)(e,2),a=n[0],s=n[1];return Object(L.a)({},a,s(t))})).reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),t)}),{});return Object(L.a)({},e,n)})).reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),t)}),{});k(e)}),[j,c]),Object(s.useEffect)((function(){for(var e in x){var t=x[e];for(var n in t)if(!1===t[n].valid)return N(!0)}N(!1)}),[x]);var w={onChangeInput:function(e,t){h((function(n){return Object(o.a)(Object(o.a)({},n),{},Object(L.a)({},e,t))})),t!==u[e]&&O((function(t){return Object(o.a)(Object(o.a)({},t),{},Object(L.a)({},e,!0))}))},isInvalid:S,formErrors:x,showErrors:_,formValues:j};return Object(a.jsx)("form",{className:n,name:t,onSubmit:function(e){e.preventDefault(),O({}),i(j)},noValidate:!0,children:Object(a.jsx)(P.Provider,{value:w,children:d})})}function U(e){var t=e.name,n=e.children,a=Object(s.useContext)(P),r=a.onChangeInput,c=a.formValues,i=a.formErrors,o=a.showErrors,u=!!i[t]&&Object.keys(i[t]).some((function(e){return!1===i[t][e].valid})),l=i[t]?Object.keys(i[t]).find((function(e){return!1===i[t][e].valid})):"",d=l?i[t][l].message:"";return n({value:c[t]?c[t]:"",isInvalid:u&&o[t],errorMessage:d,onChange:function(e){r(t,e.target.value)}})}function A(e){return(0,e.children)({disabled:Object(s.useContext)(P).isInvalid})}function I(e){var t=e.title,n=e.name,s=e.isOpen,r=e.isLoad,c=e.submitStates,i=e.validators,u=e.onClose,l=e.onSubmit,d=(e.children,e.inputsList),b=void 0===d?[]:d,p=e.defaultValues,j=b.map((function(e){return Object(a.jsx)(U,{name:e.name,children:function(t){var n=t.isInvalid,s=t.errorMessage,r=Object(w.a)(t,["isInvalid","errorMessage"]);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("input",Object(o.a)(Object(o.a)({type:"text",className:h()("popup__input popup__input_type_".concat(e.name),{popup__input_type_error:n})},e),r)),Object(a.jsx)("span",{className:h()("popup__error",{popup__error_visible:n}),children:n?s:""})]})}},"".concat(n,"-").concat(e.name))}));return Object(a.jsx)("div",{className:h()("popup popup_type_".concat(n),{popup_opened:s}),"data-name":n,onClick:function(e){e.target===e.currentTarget&&u()},children:Object(a.jsxs)(E,{className:"popup__container popup__container_type_form",name:"container",onSubmit:l,validators:i,defaultValues:p,isOpen:s,children:[Object(a.jsx)("button",{className:"popup__btn popup__btn_action_close",type:"button",onClick:u}),Object(a.jsx)("h2",{className:"popup__title",children:t}),j,Object(a.jsx)(A,{children:function(e){var t=e.disabled;return Object(a.jsx)("button",{className:h()("popup__btn","popup__btn_action_submit",{popup__btn__disabled:t}),type:"submit",disabled:t,children:r?c.loading:c.static})}})]})})}var T={name:{required:function(e){return{valid:!!e,message:"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u043b\u0435."}},minLength:function(e){return{valid:e.length>2,message:"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432: 2. \u0414\u043b\u0438\u043d\u0430 \u0442\u0435\u043a\u0441\u0442\u0430 \u0441\u0435\u0439\u0447\u0430\u0441: ".concat(e.length," \u0441\u0438\u043c\u0432\u043e\u043b.")}}},about:{required:function(e){return{valid:!!e,message:"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u043b\u0435."}},minLength:function(e){return{valid:e.length>2,message:"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432: 2. \u0414\u043b\u0438\u043d\u0430 \u0442\u0435\u043a\u0441\u0442\u0430 \u0441\u0435\u0439\u0447\u0430\u0441: ".concat(e.length," \u0441\u0438\u043c\u0432\u043e\u043b.")}}}},R=[{name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",maxLength:30},{name:"about",placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044f",maxLength:200}];function D(e){var t=e.isOpen,n=e.isLoading,r=e.onClose,c=e.onUpdateUser,i=Object(s.useContext)(f);return Object(a.jsx)(I,{title:k.title,name:k.name,isOpen:t,isLoad:n,submitStates:k.submitStates,validators:T,onClose:r,onSubmit:function(e){c(e)},defaultValues:i,inputsList:R})}var V={link:{required:function(e){return{valid:!!e,message:"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u043b\u0435."}},isUrl:function(e){return{valid:/http(s?):\/\/[-\w.]{3,}\.[A-Za-z]{2,3}/.test(e),message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441 \u0441\u0430\u0439\u0442\u0430."}}}},q=[{name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"}];function F(e){var t=e.isOpen,n=e.isLoading,s=e.onClose,r=e.onUpdateAvatar;return Object(a.jsx)(I,{title:y.title,name:y.name,isLoad:n,isOpen:t,submitStates:y.submitStates,validators:V,onClose:s,onSubmit:function(e){r(e)},defaultValues:{link:""},inputsList:q})}var J={name:{required:function(e){return{valid:""!==e,message:"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u043b\u0435."}},minLength:function(e){return{valid:e.length>2,message:"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432: 2. \u0414\u043b\u0438\u043d\u0430 \u0442\u0435\u043a\u0441\u0442\u0430 \u0441\u0435\u0439\u0447\u0430\u0441: ".concat(e.length," \u0441\u0438\u043c\u0432\u043e\u043b.")}}},link:{required:function(e){return{valid:""!==e,message:"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u043b\u0435."}},isUrl:function(e){return{valid:/http(s?):\/\/[-\w.]{3,}\.[A-Za-z]{2,3}/.test(e),message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441 \u0441\u0430\u0439\u0442\u0430."}}}},z=[{name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",maxLength:30},{name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"}];function M(e){var t=e.isOpen,n=e.isLoading,s=e.onClose,r=e.onAddPlace;return Object(a.jsx)(I,{title:x.title,name:x.name,isLoad:n,isOpen:t,submitStates:x.submitStates,validators:J,onClose:s,onSubmit:function(e){r(e)},defaultValues:{name:"",link:""},inputsList:z})}var B=n(2),G=n.n(B),H=n(8),Z=n(19),$=n(20),K=new(function(){function e(t){var n=t.baseUrl,a=t.baseUrlAuth,s=t.headers;Object(Z.a)(this,e),this._baseUrl=n,this._baseUrlAuth=a,this._headers=s}return Object($.a)(e,[{key:"_getProxy",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a={method:t,headers:this._headers};return n&&(a.body=n),fetch("".concat(this._baseUrl).concat(e),a)}},{key:"_handleResponse",value:function(){var e=Object(H.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(n=e.sent,!t.ok){e.next=7;break}return e.abrupt("return",n);case 7:return e.abrupt("return",Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(t.status,"\n\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435: ").concat(n.message)));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getUserData",value:function(){var e=Object(H.a)(G.a.mark((function e(){var t;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getProxy("/users/me","GET");case 2:return t=e.sent,e.next=5,this._handleResponse(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setUserData",value:function(){var e=Object(H.a)(G.a.mark((function e(t){var n,a,s;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,a=t.about,e.next=3,this._getProxy("/users/me","PATCH",JSON.stringify({name:n,about:a}));case 3:return s=e.sent,e.next=6,this._handleResponse(s);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setAvatar",value:function(){var e=Object(H.a)(G.a.mark((function e(t){var n,a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.link,e.next=3,this._getProxy("/users/me/avatar","PATCH",JSON.stringify({avatar:n}));case 3:return a=e.sent,e.next=6,this._handleResponse(a);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCardList",value:function(){var e=Object(H.a)(G.a.mark((function e(){var t;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getProxy("/cards","GET");case 2:return t=e.sent,e.next=5,this._handleResponse(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addCard",value:function(){var e=Object(H.a)(G.a.mark((function e(t){var n,a,s;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,a=t.link,e.next=3,this._getProxy("/cards","POST",JSON.stringify({name:n,link:a}));case 3:return s=e.sent,e.next=6,this._handleResponse(s);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteCard",value:function(){var e=Object(H.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getProxy("/cards/".concat(t),"DELETE");case 2:return n=e.sent,e.next=5,this._handleResponse(n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleCardLike",value:function(){var e=Object(H.a)(G.a.mark((function e(t,n){var a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getProxy("/cards/likes/".concat(t),n?"PUT":"DELETE");case 2:return a=e.sent,e.next=5,this._handleResponse(a);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-16",headers:{authorization:"fcd9a632-5cad-436c-b58e-4c80d498006a","Content-Type":"application/json"}});function Y(e){var t=e.isOpen,n=e.isLoading,s=e.onClose,r=e.onSubmit;return Object(a.jsx)(I,{title:C.title,name:C.name,submitStates:C.submitStates,isOpen:t,isLoad:n,onClose:s,onSubmit:function(){r()},defaultValues:{}})}function Q(e){var t=e.name,n=e.title,s=e.submitStates,r=e.isLoading,c=e.children,i=e.inputsList,u=void 0===i?[]:i,l=e.validators,d=e.onSubmit,b=u.map((function(e){return Object(a.jsx)(U,{name:e.name,children:function(t){var n=t.isInvalid,s=t.errorMessage,r=Object(w.a)(t,["isInvalid","errorMessage"]);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("input",Object(o.a)(Object(o.a)({type:"text",className:h()("auth__input auth__input_type_".concat(e.name),{auth__input_error:n})},e),r)),Object(a.jsx)("span",{className:h()("auth__error",{auth__error_visible:n}),children:n?s:""})]})}},"".concat(t,"-").concat(e.name))}));return Object(a.jsxs)(E,{className:"auth",name:"container",onSubmit:d,validators:l,defaultValues:{email:"",password:""},isOpen:!0,children:[Object(a.jsx)("p",{className:"auth__title",children:n}),Object(a.jsx)("fieldset",{className:"auth__fieldset",children:b}),Object(a.jsx)(A,{children:function(e){var t=e.disabled;return Object(a.jsx)("button",{className:h()("auth__btn","auth__btn_action_submit",{auth__btn_disabled:t}),type:"submit",disabled:t,children:r?s.loading:s.static})}}),c]})}var W={email:{required:function(e){return{valid:!!e,message:"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u043b\u0435."}},minLength:function(e){return{valid:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),message:"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 e-mail"}}},password:{required:function(e){return{valid:!!e,message:"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u043b\u0435."}},minLength:function(e){return{valid:e.length>7,message:"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432: 8. \u0414\u043b\u0438\u043d\u0430 \u0442\u0435\u043a\u0441\u0442\u0430 \u0441\u0435\u0439\u0447\u0430\u0441: ".concat(e.length," \u0441\u0438\u043c\u0432\u043e\u043b.")}}}},X=[{name:"email",placeholder:"Email"},{name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}];function ee(e){var t=e.onAuthorization;return Object(a.jsx)(Q,{name:S.name,title:S.title,submitStates:S.submitStates,isLoading:!1,validators:W,inputsList:X,onSubmit:t})}var te={email:{required:function(e){return{valid:!!e,message:"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u043b\u0435."}},minLength:function(e){return{valid:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),message:"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 e-mail"}}},password:{required:function(e){return{valid:!!e,message:"\u0412\u044b \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u043b\u0435."}},minLength:function(e){return{valid:e.length>7,message:"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432: 8. \u0414\u043b\u0438\u043d\u0430 \u0442\u0435\u043a\u0441\u0442\u0430 \u0441\u0435\u0439\u0447\u0430\u0441: ".concat(e.length," \u0441\u0438\u043c\u0432\u043e\u043b.")}}}},ne=[{name:"email",placeholder:"Email"},{name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}];function ae(e){var t=e.onRegistration;return Object(a.jsx)(Q,{name:N.name,title:N.title,submitStates:N.submitStates,isLoading:!1,validators:te,inputsList:ne,onSubmit:t,children:Object(a.jsx)(p.b,{to:"/sign-in",className:"auth__link",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438"})})}var se=n.p+"static/media/failure.d4ce2a26.svg",re=n.p+"static/media/success.a9eb6caf.svg";function ce(e){var t=e.isSuccess,n=e.message,s=e.isOpen,r=e.onClose;return Object(a.jsx)("div",{className:"popup ".concat(s?"popup_opened":""),onClick:function(e){e.target===e.currentTarget&&r()},children:Object(a.jsxs)("div",{className:"popup__container popup__container_type_form popup__container_align_center",children:[Object(a.jsx)("button",{className:"popup__btn popup__btn_action_close",type:"button",onClick:r}),Object(a.jsx)("img",{src:t?re:se,alt:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438",className:"popup__info-icon"}),Object(a.jsx)("h3",{className:"popup__title popup__title_align_center",children:n})]})})}var ie=new(function(){function e(t){var n=t.baseUrlAuth,a=t.headers;Object(Z.a)(this,e),this._baseUrl=n,this._headers=a}return Object($.a)(e,[{key:"_getProxy",value:function(e){var t=e.relativePath,n=e.method,a=e.body,s=void 0===a?"":a,r=e.headers,c=void 0===r?{}:r,i={method:n,headers:Object(o.a)(Object(o.a)({},this._headers),c)};return s&&(i.body=s),fetch("".concat(this._baseUrl).concat(t),i)}},{key:"_handleResponse",value:function(){var e=Object(H.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(n=e.sent,!t.ok){e.next=7;break}return e.abrupt("return",n);case 7:return e.abrupt("return",Promise.reject({status:t.status,message:n.message?n.message:n.error?n.error:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!\n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"tokenCheck",value:function(){var e=Object(H.a)(G.a.mark((function e(t){var n,a,s;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.jwt,a={relativePath:"/users/me",method:"GET",headers:{Authorization:"Bearer ".concat(n)}},e.next=4,this._getProxy(a);case 4:return s=e.sent,e.next=7,this._handleResponse(s);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signUp",value:function(){var e=Object(H.a)(G.a.mark((function e(t){var n,a,s,r;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.password,a=t.email,s={relativePath:"/signup",method:"POST",body:JSON.stringify({password:n,email:a})},e.next=4,this._getProxy(s);case 4:return r=e.sent,e.next=7,this._handleResponse(r);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signIn",value:function(){var e=Object(H.a)(G.a.mark((function e(t){var n,a,s,r;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.password,a=t.email,s={relativePath:"/signin",method:"POST",body:JSON.stringify({password:n,email:a})},e.next=4,this._getProxy(s);case 4:return r=e.sent,e.next=7,this._handleResponse(r);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}())({baseUrlAuth:"https://auth.nomoreparties.co",headers:{"Content-Type":"application/json"}}),oe=function(e){var t=e.children,n=Object(w.a)(e,["children"]);return Object(a.jsx)(d.b,{children:function(){return n.loggedIn?t:Object(a.jsx)(d.a,{to:"/sign-in"})}})};var ue=function(){var e=Object(d.g)(),t=Object(s.useState)(!1),n=Object(l.a)(t,2),r=n[0],c=n[1],i=Object(s.useState)(!1),p=Object(l.a)(i,2),j=p[0],h=p[1],_=Object(s.useState)(!1),x=Object(l.a)(_,2),k=x[0],y=x[1],C=Object(s.useState)(!1),S=Object(l.a)(C,2),N=S[0],w=S[1],L=Object(s.useState)(!1),P=Object(l.a)(L,2),E=P[0],U=P[1],A=Object(s.useState)(!1),I=Object(l.a)(A,2),T=I[0],R=I[1],V=Object(s.useState)({}),q=Object(l.a)(V,2),J=q[0],z=q[1],B=Object(s.useState)({}),G=Object(l.a)(B,2),H=G[0],Z=G[1],$=Object(s.useState)([]),Q=Object(l.a)($,2),W=Q[0],X=Q[1],te=Object(s.useState)(!1),ne=Object(l.a)(te,2),se=ne[0],re=ne[1],ue=Object(s.useState)({}),le=Object(l.a)(ue,2),de=le[0],be=le[1],pe=Object(s.useState)(!1),je=Object(l.a)(pe,2),he=je[0],fe=je[1],me=Object(s.useState)(""),_e=Object(l.a)(me,2),Oe=_e[0],ve=_e[1];Object(s.useEffect)((function(){K.getCardList().then((function(e){X(e)})).catch((function(e){console.log(e)})).finally((function(){}))}),[]),Object(s.useEffect)((function(){K.getUserData().then((function(e){Z(e)})).catch(console.log).finally((function(){}))}),[]),Object(s.useEffect)((function(){if(localStorage.getItem("jwt")){var e=localStorage.getItem("jwt");ie.tokenCheck({jwt:e}).then((function(e){var t=e.data;fe(!0),ve(t.email)})).catch(console.log).finally((function(){}))}}),[]),Object(s.useEffect)((function(){he&&e.push("/")}),[he,e]);var ge=function(){y(!1),c(!1),h(!1),w(!1),U(!1),R(!1)};return Object(s.useEffect)((function(){Object.keys(de).length>0&&R(!0)}),[de]),Object(a.jsx)(f.Provider,{value:Object(o.a)(Object(o.a)({},H),{},{email:Oe}),children:Object(a.jsxs)("div",{className:"page",onKeyDown:function(e){"Escape"===e.key&&ge()},children:[Object(a.jsx)(m,{logo:b,loggedIn:he,onExit:function(){localStorage.removeItem("jwt"),fe(!1),e.push("/login")}}),Object(a.jsxs)(d.d,{children:[Object(a.jsxs)(oe,{exact:!0,path:"/",loggedIn:he,children:[Object(a.jsx)(O,{onEditProfile:function(){c(!0)},onAddPlace:function(){h(!0)},onEditAvatar:function(){y(!0)},cards:W,onCardClick:function(e){U(!0),z(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===H._id}));K.toggleCardLike(e._id,!t).then((function(t){var n=W.map((function(n){return n._id===e._id?t:n}));X(n)})).catch(console.log)},onCardDelete:function(e){z(e),w(!0)}}),Object(a.jsx)(v,{}),Object(a.jsx)(M,{isOpen:j,isLoading:se,onClose:ge,onAddPlace:function(e){re(!0),K.addCard(e).then((function(e){X([e].concat(Object(u.a)(W))),ge()})).catch(console.log).finally((function(){re(!1)}))}}),Object(a.jsx)(D,{isOpen:r,isLoading:se,onClose:ge,onUpdateUser:function(e){re(!0),K.setUserData(e).then((function(e){Z(e),ge()})).catch(console.log).finally((function(){re(!1)}))}}),Object(a.jsx)(F,{isOpen:k,isLoading:se,onClose:ge,onUpdateAvatar:function(e){re(!0),K.setAvatar(e).then((function(e){Z(e),ge()})).catch(console.log).finally((function(){re(!1)}))}}),Object(a.jsx)(g,{card:J,isOpen:E,onClose:ge}),Object(a.jsx)(Y,{isOpen:N,isLoading:se,onClose:ge,onSubmit:function(){re(!0),K.deleteCard(J._id).then((function(){var e=W.filter((function(e){return e._id!==J._id}));X(e),ge()})).catch(console.log).finally((function(){re(!1)}))}})]}),Object(a.jsx)(d.b,{path:"/sign-in",children:Object(a.jsx)(ee,{onAuthorization:function(e){re(!0),ie.signIn(e).then((function(e){return e.token&&localStorage.setItem("jwt",e.token),e})).then((function(t){fe(!0),ve(e.email)})).catch((function(e){be({success:!1,message:e.message})})).finally((function(){re(!1)}))}})}),Object(a.jsx)(d.b,{path:"/sign-up",children:Object(a.jsx)(ae,{onRegistration:function(e){re(!0),ie.signUp(e).then((function(e){be({success:!0,message:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"})})).catch((function(e){be({success:!1,message:e.message})})).finally((function(){re(!1)}))}})})]}),Object(a.jsx)(ce,{isSuccess:de.success,message:de.message,isOpen:T,onClose:ge})]})})},le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,41)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),s(e),r(e),c(e)}))};i.a.render(Object(a.jsx)(p.a,{children:Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(ue,{})})}),document.getElementById("root")),le()}},[[40,1,2]]]);
//# sourceMappingURL=main.6a64ff1e.chunk.js.map